### üöÄ –°–ø—Ä–∏–Ω—Ç ‚Ññ5: Cash & Payroll (–§–∏–Ω–∞–Ω—Å—ã –∏ –í—ã–ø–ª–∞—Ç—ã)

**–¶–µ–ª—å:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–æ–≥–æ —É—á–µ—Ç–∞ –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏.

---

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –°–ø—Ä–∏–Ω—Ç–∞ ‚Ññ5

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –•–æ—Ä–æ—à–∏–π | –õ—É—á—à–∏–π | –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π (–ú–æ–π –≤—ã–±–æ—Ä) |
| --- | --- | --- | --- |
| **–õ–æ–≥–∏–∫–∞ –≤—ã–ø–ª–∞—Ç** | –ü—Ä–æ—Å—Ç–æ–µ —É–º–Ω–æ–∂–µ–Ω–∏–µ —á–∞—Å–æ–≤ –Ω–∞ —Å—Ç–∞–≤–∫—É. | –£—á–µ—Ç –ø—Ä–µ–º–∏–π –∏ —à—Ç—Ä–∞—Ñ–æ–≤ –≤—Ä—É—á–Ω—É—é. | **Automated Payment Split**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–¥–µ–ª –Ω–∞ "–ë–µ–ª—É—é" (–∫–∞—Ä—Ç–æ–π) –∏ "–°–µ—Ä—É—é" (–∫–∞—Å—Å–∞) —á–∞—Å—Ç–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞–ª–æ–≥–æ–≤—ã—Ö —Å—Ö–µ–º. |
| **–¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö** | –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–æ–¥–æ–∫. | –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. | **Strict Immutability & Storno**: –ü–æ–ª–Ω—ã–π –∑–∞–ø—Ä–µ—Ç –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω–∏–∑–º **–°—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**. |
| **–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏** | –†—É—á–Ω–∞—è —Å–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–∞ –≤ —Å–µ–π—Ñ–µ. | –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞. | **Predictive Safe Balance**: –ê–Ω–∞–ª–∏–∑ –¥–∏–Ω–∞–º–∏–∫–∏ –∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–¢—Ä–µ–±—É–µ—Ç—Å—è –∏–Ω–∫–∞—Å—Å–∞—Ü–∏—è" –¥–æ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è —Å–µ–π—Ñ–∞. |
| **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** | –¢–∞–±–ª–∏—Ü—ã –≤ Excel. | –ì—Ä–∞—Ñ–∏–∫–∏ –≤—ã—Ä—É—á–∫–∏ –ø–æ –¥–Ω—è–º. | **Revenue vs Labor Chart**: –í–∏–∑—É–∞–ª—å–Ω–æ–µ –Ω–∞–ª–æ–∂–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç –Ω–∞ –ø–µ—Ä—Å–æ–Ω–∞–ª –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –≤—ã—Ä—É—á–∫–∏ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è Labor Cost %. |

---

#### 1. –†–∞—Å—á–µ—Ç–Ω—ã–π —Ü–µ–Ω—Ç—Ä (Module 04: Payroll Logic)

* **Payment Split Algorithm**: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –≤—ã–ø–ª–∞—Ç: **Official Base** (–Ω–∞ –∫–∞—Ä—Ç—É —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–≥–æ–≤–æ—Ä—É) –∏ **Cash Balance** (–æ—Å—Ç–∞—Ç–æ–∫ –∏–∑ –∫–∞—Å—Å—ã).
* **Rate Snapshot Calculation**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤ –°–ø—Ä–∏–Ω—Ç–µ ‚Ññ4 —Å—Ç–∞–≤–æ–∫ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å—á–µ—Ç–∞, —á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –∫–æ–ª–ª–∏–∑–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞—Ä–ø–ª–∞—Ç –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ –º–µ—Å—è—Ü–∞.
* **Bonus/Penalty Log**: –†–µ–µ—Å—Ç—Ä –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–æ–∫ ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç—è–≥–∏–≤–∞–Ω–∏–µ –ø—Ä–µ–º–∏–π –∑–∞ –∞—Ç—Ç–µ—Å—Ç–∞—Ü–∏—é (–∏–∑ –ú–æ–¥—É–ª—è 06) –∏ –≤—ã—á–µ—Ç–æ–≤ –∑–∞ –∏–Ω—Ü–∏–¥–µ–Ω—Ç—ã (–∏–∑ –ú–æ–¥—É–ª—è 08).
* **Mass Approval**: –§—É–Ω–∫—Ü–∏—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —Ç–∞–±–µ–ª—è –≤—Å–µ–π —Å–µ—Ç–∏ –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö.

#### 2. –£—á–µ—Ç –Ω–∞–ª–∏—á–Ω–æ—Å—Ç–∏ (Module 05: Cash Management)

* **Z-Report Photo Audit**: –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–∫—Ä—ã—Ç–∏—è —Å–º–µ–Ω—ã —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º –≤–≤–æ–¥–æ–º –≤—ã—Ä—É—á–∫–∏ (–ù–∞–ª/–ë–µ–∑–Ω–∞–ª) –∏ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º —Ñ–æ—Ç–æ —á–µ–∫–∞ Z-–æ—Ç—á–µ—Ç–∞ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏.
* **Cash Gap Alerting**: –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π –º–µ–∂–¥—É —Ä–∞—Å—á–µ—Ç–Ω–æ–π –∏ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –Ω–∞–ª–∏—á–Ω–æ—Å—Ç—å—é –≤ —Å–µ–π—Ñ–µ.
* **Operational Expenses (OPEX)**: –£—á–µ—Ç –º–µ–ª–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ (—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω—É–∂–¥—ã, –æ–±–µ–¥—ã) —Å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º —Ñ–æ—Ç–æ-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º —á–µ–∫–æ–≤.
* **Collection Handshake**: –ú–µ—Ö–∞–Ω–∏–∑–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–Ω–∫–∞—Å—Å–∞—Ü–∏–∏ (–ø–µ—Ä–µ–¥–∞—á–∏ –¥–µ–Ω–µ–≥ –æ—Ç —Ç–æ—á–∫–∏ –í–ª–∞–¥–µ–ª—å—Ü—É), —Ç—Ä–µ–±—É—é—â–∏–π "–∞–∫—Ü–µ–ø—Ç–∞" –ø—Ä–∏–Ω–∏–º–∞—é—â–µ–π —Å—Ç–æ—Ä–æ–Ω—ã.

#### 3. –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∏ –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (UI/UX)

* **Staff Paystub**: –î–µ—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –±–∞—Ä–∏—Å—Ç–∞ —Å Time Log, —Ä–µ–µ—Å—Ç—Ä–æ–º –ø—Ä–µ–º–∏–π –∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º **Salary Trend**.
* **Glassmorphism Financial Cards**: –ö–∞—Ä—Ç–æ—á–∫–∏ –æ—Ç—á–µ—Ç–æ–≤ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –º–∏–∫—Å–∏–Ω–∞ `@include glass-morphism` –∏ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º —Å—Ç–∞—Ç—É—Å–æ–≤ (Emerald –¥–ª—è –≤—ã–ø–ª–∞—á–µ–Ω–æ, Amber –¥–ª—è –æ–∂–∏–¥–∞–Ω–∏—è).
* **Net Cash Flow Dashboard**: –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –í–ª–∞–¥–µ–ª—å—Ü–∞: –í—ã—Ä—É—á–∫–∞ –∑–∞ –≤—ã—á–µ—Ç–æ–º COGS, OPEX –∏ –§–û–¢ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.

---

### –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è: –°—Ö–µ–º–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏ –≤—ã–ø–ª–∞—Ç

```typescript
// prisma/schema.prisma (–¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)

model Transaction {
  id              String           @id @default(cuid())
  businessId      String           @index
  unitId          String?          @index
  
  amount          Int              // –°—É–º–º–∞ –≤ –∫–æ–ø–µ–π–∫–∞—Ö
  type            TransactionType  // REVENUE, EXPENSE, PAYROLL, TRANSFER
  category        String           // –ê—Ä–µ–Ω–¥–∞, –ó–ü, –ü—Ä–æ–¥—É–∫—Ç—ã, Z-–æ—Ç—á–µ—Ç
  
  accountType     AccountType      // CASH, CARD, SAFE
  
  status          TransactionStatus @default(COMPLETED)
  isStorno        Boolean          @default(false)
  relatedTransId  String?          // –°—Å—ã–ª–∫–∞ –Ω–∞ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø—Ä–∏ —Å—Ç–æ—Ä–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏
  
  evidenceUrl     String?          // –§–æ—Ç–æ —á–µ–∫–∞ –∏–ª–∏ Z-–æ—Ç—á–µ—Ç–∞
  comment         String?
  authorId        String
  
  createdAt       DateTime         @default(now())
}

enum TransactionType {
  REVENUE
  EXPENSE
  PAYROLL
  TRANSFER
  CORRECTION
}

enum AccountType {
  CASH
  CARD
  SAFE
}

enum TransactionStatus {
  PENDING
  COMPLETED
  CANCELLED
}

/**
 * [EVAS_PROTIP]: –ú—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º $transaction –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω–æ—Å—Ç–∏ —Å–ø–ª–∏—Ç-–≤—ã–ø–ª–∞—Ç: 
 * –µ—Å–ª–∏ –æ–¥–Ω–∞ —á–∞—Å—Ç—å (Card) –ø—Ä–æ—à–ª–∞, –∞ –≤—Ç–æ—Ä–∞—è (Cash) —É–ø–∞–ª–∞ —Å –æ—à–∏–±–∫–æ–π, 
 * –≤—Å—è –æ–ø–µ—Ä–∞—Ü–∏—è –æ—Ç–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è.
 */

```

```typescript
// prisma.config.ts
import { Prisma } from '@prisma/client';

export const prismaConfig: Prisma.PrismaClientOptions = {
  log: ['error', 'warn'],
  errorFormat: 'pretty',
};

```
